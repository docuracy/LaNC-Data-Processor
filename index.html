<!DOCTYPE html>
<html lang="en">
<!--

Copyright (C) 2021 Stephen Gadd - All Rights Reserved
Released under CC-BY 4.0 International Licence
For details see https://github.com/docuracy/Locolligo/blob/main/LICENSE.md

-->
<head>
	<meta charset="UTF-8">
	<title>Locolligo: Historical Geodata Curator</title>
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
	<script src="./js/jquery-3.6.0.min.js"></script>
	<script src="./js/jquery-ui.min.js"></script>
	<script src="./js/jsonata.min.js">// From https://github.com/jsonata-js/jsonata</script>
	<script src="./js/papaparse.min.js">// From https://github.com/mholt/PapaParse</script>
	<script src="./js/json-formatter.umd.min.js">// From https://github.com/mohsen1/json-formatter-js</script>
	<script src="./js/uuidv4.min.js">// From https://github.com/uuidjs/uuid</script>
	<script src="./js/proj4.js">// From https://github.com/proj4js/proj4js</script>
	<script src="./js/fxparser.min.js">// https://github.com/NaturalIntelligence/fast-xml-parser</script>
	<script src="./js/jquery.loadingModal.min.js">// From https://github.com/do-web/jquery-loadingModal</script>
	<script src="./js/data-converter.js"></script>
	<link rel="stylesheet" href="./css/jquery-ui.min.css">
	<link rel="stylesheet" href="./css/jquery-ui.theme.min.css">
	<link rel="stylesheet" href="./css/jquery.loadingModal.min.css">
	<link rel="stylesheet" href="./css/dc.css">
	<link href="./css/mapbox-gl.css" rel="stylesheet">
	<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
	<style>@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@100&display=swap');</style>
	<script src="./js/mapbox-gl.js"></script>
	<base target="_blank">
</head>
<body>
	<div id="header">
		<a class="logo" aria-label="Locolligo" title="About Locolligo: Historical Geodata Curator" href="https://github.com/docuracy/Locolligo/blob/main/README.md">{Lo<span>co:lligo</span>}</a>
	</div>
	<div id="source" class="json-formatter">
		<span id="source_block">
			<span class="initial" title="Use the options to Upload, Fetch, or Select an input dataset.">{input}</span>
			<table>
				<tr>
					<td>
						<select id="choose_input">
							<option selected disabled="true">Choose Input</option>
							<option value="upload">Upload</option>
							<option value="fetch">Fetch from URL</option>
							<option value="sample">Try Example</option>
						</select>
					</td>
					<td>
						<div id="inputs">
							<input type="file" id="file_source" name="file_source" title="Delimited text filenames must end with .csv or .tsv"> 
							<input type="text" id="datafile_url" title="Delimited text filenames must end with .csv or .tsv" placeholder="Datafile URL (JSON/CSV/TSV/XML/KML)"/><button id="fetch">Fetch</button> 
							<select name="examples" id="examples"><option selected disabled="true">Select Example Dataset</option></select>
						</div>
					</td>
				</tr>
			</table>
			<span class="bg-text">tsv kml json xml csv</span>
		</span>
	</div>
	<div class="arrow"><div class="arrow__body"></div></div>
	<div id="output" class="json-formatter"><span class="initial" title="After choosing an input dataset, you may adjust the conversion type. Conversions are not yet configurable.">{output}</span><span class="bg-text">csv geoJSON-T JSON-LD ttl</span></div>
	<div id="footer">Copyright &copy; 2021 Stephen Gadd - All Rights Reserved<br/>Released under <a href="https://github.com/docuracy/Locolligo/blob/main/LICENSE.md">CC-BY 4.0 International Licence</a></div>
	<div id="modal" title="JSONata Expression"><p>Paste unescaped JSONata expression here: converted code will be copied to the clipboard and temporarily assigned to the selected conversion type.</p><p>Afterwards, download and replace your mappings.json file to make the assigment permanent.</p><textarea id="JSONata_area" rows="5" cols="67"></textarea></div>
	<div id="map"></div>
	<div id="darkroom">
		<div id="conversions">
			<label for="expression">Conversion type:</label><select name="expression" id="expression"></select>
		</div>
		<div id="layerSelector" class="expandingButton">
			<span class="fence"></span>
		</div>
		<div id="geocodeWrapper" class="expandingButton">
			<input id="geocode" class="mapboxgl-ctrl" title="Not yet implemented" placeholder="Find" type="find" />
		</div>
	</div>
	<script type="module">
        import OsGridRef from './js/geodesy/osgridref.js'; // From https://www.movable-type.co.uk/scripts/latlong-os-gridref.html
		window.OsGridRef = OsGridRef;
    </script>
	<script>
		// Initialise map
		mapboxgl.accessToken = 'pk.eyJ1IjoiZG9jdXJhY3kiLCJhIjoiY2t3dnp0NmhkMDhwNzMwczhwa2VicGJoeSJ9.Gf3x44EB9xZfotN-gC0DBQ';
		map = new mapboxgl.Map({
		    container: 'map',
		    style: 'https://raw.githubusercontent.com/docuracy/LaNC-peripleo-lite/main/src/map/nls.json',
		    center: [0, 51],
		    zoom: 9 
		});
		map
			.addControl(new mapboxgl.NavigationControl())
			.on('idle',function(){ map.resize(); });
	</script>
</body>
</html>
